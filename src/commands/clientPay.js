// –ø–ª–∞—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ¬´–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å¬ª

const { Markup } = require("telegraf");

module.exports = (bot) => {
  // –∫–Ω–æ–ø–∫–∞ ¬´–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–ø–ª–∞—Ç–Ω–æ)¬ª –∏–∑ –º–µ–Ω—é
  bot.action("compat_start", async (ctx) => {
    await ctx.answerCbQuery();
    ctx.reply(
      "üí≥ –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤—å 10 ‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É:\n\n" +
        "2202 2006 1234 5678\n\n" +
        "–ó–∞—Ç–µ–º –ø—Ä–∏—à–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–ª–∏ —á–µ–∫ —Å—é–¥–∞ üëá"
    );
  });

  // /compat ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–±—Ä–∞–ª –≤—Ä—É—á–Ω—É—é
  bot.command("compat", (ctx) => {
    ctx.reply(
      "üí≥ –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤—å 10 ‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É:\n\n" +
        "2202 2006 1234 5678\n\n" +
        "–ó–∞—Ç–µ–º –ø—Ä–∏—à–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–ª–∏ —á–µ–∫ —Å—é–¥–∞ üëá"
    );
  });

  // –ø—Ä–∏—ë–º —á–µ–∫–æ–≤ (—Ñ–æ—Ç–æ/–¥–æ–∫)
  bot.on(["photo", "document"], async (ctx) => {
    const user = ctx.from;

    // —Å–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    await ctx.reply(
      "üì© –ß–µ–∫ –ø–æ–ª—É—á–µ–Ω! –ü—Ä–æ–≤–µ—Ä—é –∏ –¥–∞–º –∑–Ω–∞—Ç—å, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –æ–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—Å—è."
    );

    // –ø–µ—Ä–µ—Å—ã–ª–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –∞–¥–º–∏–Ω—É
    const fwdMsg = await ctx.forwardMessage(process.env.ADMIN_ID);

    // –ø–æ–¥ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º ‚Äî –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞
    await bot.telegram.sendMessage(
      process.env.ADMIN_ID,
      `üßæ –ß–µ–∫ –æ—Ç @${user.username || "–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"} (ID: ${user.id})`,
      Markup.inlineKeyboard([
        Markup.button.callback("‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ", `grant_ok_${user.id}`),
        Markup.button.callback("‚ùå –ù–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ", `grant_no_${user.id}`),
      ])
    );
  });
};